<!DOCTYPE html>
<html>

<head>
    <title>Azure AD Auth - Static App</title>
    <script src="https://alcdn.msauth.net/browser/2.35.0/js/msal-browser.min.js"></script>
</head>

<body>
    <h1>Welcome to My App</h1>
    <div id="auth-section">
        <button onclick="signIn()">Sign In</button>
    </div>
    <div id="user-section" style="display: none;">
        <p id="welcome-msg"></p>
        <button onclick="signOut()">Sign Out</button>
    </div>

    <script>
        const msalConfig = {
            auth: {
                clientId: "YOUR_CLIENT_ID", // from Azure
                authority: "https://login.microsoftonline.com/YOUR_TENANT_ID", // from Azure
                redirectUri: "https://your-domain.com/" // EXACT match to Azure app
            }
        };

        const msalInstance = new msal.PublicClientApplication(msalConfig);

        async function signIn() {
            try {
                const loginResponse = await msalInstance.loginPopup({
                    scopes: ["user.read"]
                });
                showWelcomeMessage(loginResponse.account);
            } catch (err) {
                console.error("Login error:", err);
            }
        }

        function signOut() {
            const account = msalInstance.getAllAccounts()[0];
            msalInstance.logoutPopup({ account }).then(() => {
                document.getElementById('auth-section').style.display = 'block';
                document.getElementById('user-section').style.display = 'none';
            });
        }

        function showWelcomeMessage(account) {
            document.getElementById('auth-section').style.display = 'none';
            document.getElementById('user-section').style.display = 'block';
            document.getElementById('welcome-msg').textContent = "Hello, " + account.username;
        }

        // Automatically show user info if already logged in
        const currentAccount = msalInstance.getAllAccounts()[0];
        if (currentAccount) {
            showWelcomeMessage(currentAccount);
        }
    </script>
</body>

</html>